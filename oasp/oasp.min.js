angular.module("oasp",["oasp.oaspUi","oasp.oaspSecurity","oasp.oaspI18n"]),angular.module("oasp.oaspSecurity",[]).config(["$httpProvider",function(e){"use strict";e.interceptors.push("oaspSecurityInterceptor")}]).run(["oaspSecurityService",function(e){"use strict";e.checkIfUserIsLoggedInAndIfSoReinitializeAppContext()}]),angular.module("oasp.oaspSecurity").factory("oaspSecurityInterceptor",["$q","oaspUnauthenticatedRequestResender",function(e,n){"use strict";return{responseError:function(t){var a;return 403===t.status?(a=t.config,n.addRequest(a)):e.reject(t)}}}]),angular.module("oasp.oaspSecurity").provider("oaspSecurityService",function(){"use strict";var e={securityRestServiceName:"securityRestService",appContextServiceName:"appContext"};return{setSecurityRestServiceName:function(n){e.securityRestServiceName=n||e.securityRestServiceName},setAppContextServiceName:function(n){e.appContextServiceName=n||e.appContextServiceName},$get:["$injector","$http","$q",function(n,t,a){var o={set:function(e,n){this.headerName=e,this.token=n},invalidate:function(){this.headerName=void 0,this.token=void 0}},r=function(){return{hasToken:function(){return o.headerName&&o.token?!0:!1},getHeaderName:function(){return o.headerName},getToken:function(){return o.token}}}(),i=function(){var e,n,t=!1;return{initializationStarts:function(){t=!0,n=a.defer()},initializationSucceeded:function(a){e=a,t=!1,n.resolve(e),n=void 0},initializationFailed:function(){e=void 0,t=!1,n.resolve(e),n=void 0},userLoggedOff:function(){e=void 0},getProfile:function(){return t?n.promise:a.when(e)}}}(),u=function(){return n.get(e.securityRestServiceName)},s=function(){return n.get(e.appContextServiceName)},c=function(){return u().getCsrfToken().then(function(e){var n=e.data;return t.defaults.headers.common[n.headerName]=n.token,o.set(n.headerName,n.token),n},function(){return a.reject("Requesting a CSRF token failed")})};return{logIn:function(e,n){var t=a.defer();return i.initializationStarts(),u().login(e,n).then(function(){a.all([u().getCurrentUser(),c()]).then(function(e){var n=e[0].data;i.initializationSucceeded(n),s().onLoggingIn(n),t.resolve()},function(e){i.initializationFailed(),t.reject(e)})},function(){i.initializationFailed(),t.reject("Authentication failed")}),t.promise},logOff:function(){return u().logout().then(function(){o.invalidate(),i.userLoggedOff(),s().onLoggingOff()})},checkIfUserIsLoggedInAndIfSoReinitializeAppContext:function(){i.initializationStarts(),u().getCurrentUser().then(function(e){var n=e.data;c().then(function(){i.initializationSucceeded(n),s().onLoggingIn(n)},function(){i.initializationFailed()})},function(){i.initializationFailed()})},getCurrentCsrfToken:function(){return r},getCurrentUserProfile:function(){return i.getProfile()}}}]}}),angular.module("oasp.oaspSecurity").provider("oaspUnauthenticatedRequestResender",function(){"use strict";var e={authenticatorServiceName:"authenticator"};return{setAuthenticatorServiceName:function(n){e.authenticatorServiceName=n||e.authenticatorServiceName},$get:["$q","$injector",function(n,t){var a={queue:[],push:function(e){this.queue.push(e)},resendAll:function(e){for(;this.queue.length;)this.queue.shift().resend(e)},cancelAll:function(){for(;this.queue.length;)this.queue.shift().cancel()}},o=function(){return t.get("oaspSecurityService")},r=function(){return t.get(e.authenticatorServiceName)},i=function(){var e=!0;return function(n,t){e&&(r().execute().then(function(){n(),e=!0},function(){t(),e=!0}),e=!1)}}();return{addRequest:function(e){var r=n.defer(),u={resend:function(n){var a=function(e,n){var a=t.get("$http");return e.headers[n.headerName]=n.token,a(e)};a(e,n).then(function(e){r.resolve(e)},function(e){r.reject(e)})},cancel:function(){r.reject()}},s=function(){var e=o().getCurrentCsrfToken();a.resendAll({headerName:e.getHeaderName(),token:e.getToken()})},c=function(){a.cancelAll()};return a.push(u),i(s,c),r.promise}}}]}}),angular.module("oasp.oaspUi.oaspGrid",["oasp.oaspUi.templates","trNgGrid"]).run(function(){"use strict";TrNgGrid.tableCssClass="tr-ng-grid table table-striped"}),angular.module("oasp.oaspUi.buttonBar",["oasp.oaspUi.templates"]),angular.module("oasp.oaspUi.modal",["oasp.oaspUi.spinner","ui.bootstrap.modal","oasp.oaspUi.templates"]),angular.module("oasp.oaspUi.spinner",["angularSpinner","oasp.oaspUi.templates"]),angular.module("oasp.oaspUi",["oasp.oaspUi.oaspGrid","oasp.oaspUi.spinner","oasp.oaspUi.modal","oasp.oaspUi.buttonBar"]),angular.module("oasp.oaspUi.buttonBar").directive("buttonBar",function(){"use strict";return{restrict:"EA",replace:!0,templateUrl:"oasp/oasp-ui/html/button-bar/button-bar.html",scope:{buttonDefs:"="},link:function(e){e.onButtonClick=function(e){e&&angular.isFunction(e.onClick)&&e.onClick.apply(void 0,arguments)},e.isButtonDisabled=function(e){return e&&angular.isFunction(e.isActive)?!e.isActive.apply(void 0,arguments):e&&angular.isFunction(e.isNotActive)?e.isNotActive.apply(void 0,arguments):!0}}}}),angular.module("oasp.oaspUi.modal").constant("oaspUiModalDefaults",{backdrop:"static",keyboard:!1}).config(["$provide","oaspUiModalDefaults",function(e,n){"use strict";var t=function(e,t){return{open:function(a){t.show();var o=e.open(angular.extend({},n,a));return o.opened.then(function(){t.hide()},function(){t.hide()}),o}}};t.$inject=["$delegate","globalSpinner"],e.decorator("$modal",t)}]),angular.module("oasp.oaspUi.spinner").factory("globalSpinner",["$rootScope","$q",function(e,n){"use strict";var t={};return t.show=function(){e.globalSpinner=!0},t.hide=function(){e.globalSpinner=!1},t.showOnRouteChangeStartAndHideWhenComplete=function(){e.$on("$routeChangeStart",function(e,n){n.resolve&&t.show()}),e.$on("$routeChangeSuccess",function(){t.hide()}),e.$on("$routeChangeError",function(){t.hide()})},t.decorateCallOfFunctionReturningPromise=function(e){return t.show(),e().then(function(e){return t.hide(),e},function(e){return t.hide(),n.reject(e)})},t}]),angular.module("oasp.oaspUi.spinner").constant("spinnerOptions",{lines:13,length:20,width:4,radius:16,corners:1,rotate:0,color:"#ffffff",speed:1.2,trail:54,shadow:!1,hwaccel:!1,zIndex:2e9}).directive("spinner",["spinnerOptions",function(e){"use strict";return{restrict:"A",replace:!0,templateUrl:"oasp/oasp-ui/html/spinner/spinner.html",scope:{spinnerVisible:"=spinner"},link:function(n){n.spinnerOptions=e}}}]),angular.module("oasp.oaspUi.templates",[]).run(["$templateCache",function(e){e.put("oasp/oasp-ui/html/button-bar/button-bar.html",'<div class="btn-group btn-group-sm" role="group"><button data-ng-repeat="buttonDef in buttonDefs" data-ng-click="onButtonClick(buttonDef)" data-ng-disabled="isButtonDisabled(buttonDef)" class="btn btn-sm btn-default"><span data-ng-bind="buttonDef.label"></span></button></div>'),e.put("oasp/oasp-ui/html/spinner/spinner.html",'<div class="spinner-container" data-ng-show="spinnerVisible"><div class="spinner-backdrop"></div><span us-spinner="spinnerOptions" data-spinner-start-active="1"></span></div>')}]),angular.module("oasp.oaspI18n",["pascalprecht.translate","oasp.oaspI18n.templates"],["$translateProvider","$httpProvider",function(e,n){"use strict";n.interceptors.push("templateLoadTranslationInterceptor"),e.useLoader("$translatePartialLoader",{urlTemplate:"{part}/i18n/locale-{lang}.json"})}]).run(["$rootScope","$translate","$translatePartialLoader",function(e,n,t){"use strict";var a=function(e){t.addPart(e),n.refresh()};e.$on("translationPartChange",function(e,n){a(n,e)})}]),angular.module("oasp.oaspI18n").provider("oaspTranslation",["$translatePartialLoaderProvider","$translateProvider",function(e,n){"use strict";var t,a=[],o=[],r=function(){var e,n;if(o&&o.length)for(n=o[0],e=0;e<o.length;e+=1)o[e].default===!0&&(n=o[e]);return n};this.enableTranslationForModule=function(n,o){if(a.indexOf(n)<0&&a.push(n),o===!0){if(t)throw new Error("Default module already specified defaultModule="+t);t=n,e.addPart(t)}},this.setSupportedLanguages=function(e){if(o&&o.length)throw new Error("Supported languages already specified");o=e,r()&&n.preferredLanguage(r().key)},this.$get=[function(){return{moduleHasTranslations:function(e){return a.indexOf(e)>-1},getDefaultTranslationModule:function(){return t},getSupportedLanguages:function(){return o},getDefaultLanguage:r}}]}]),angular.module("oasp.oaspI18n").service("templateLoadTranslationInterceptor",["$rootScope","oaspTranslation",function(e,n){"use strict";var t=new RegExp("/?([^/]+)/html/");return{request:function(a){if(a.url){var o=t.exec(a.url);o&&o.length>1&&n.moduleHasTranslations(o[1])&&e.$emit("translationPartChange",o[1])}return a}}}]),angular.module("oasp.oaspI18n").controller("LanguageChangeCntl",["$scope","$translate","oaspTranslation",function(e,n,t){"use strict";e.supportedLanguages=t.getSupportedLanguages(),e.changeLanguage=function(e){n.use(e)},e.getCurrentLanguage=function(){return n.use()}}]),angular.module("oasp.oaspI18n").directive("languageChange",function(){"use strict";return{restrict:"EA",scope:!0,replace:!0,controller:"LanguageChangeCntl",templateUrl:"oasp/oasp-i18n/html/language-change.html"}}),angular.module("oasp.oaspI18n.templates",[]).run(["$templateCache",function(e){e.put("oasp/oasp-i18n/html/language-change.html",'<li class="dropdown language-dropdown" dropdown=""><a href="" class="dropdown-toggle" dropdown-toggle=""><span class="icon-container"><span class="icon icon-{{getCurrentLanguage()}}-24"></span></span><span translate="">OASP.LANGUAGE</span><span class="caret"></span></a><ul class="dropdown-menu" role="menu"><li ng-repeat="lang in supportedLanguages" ng-show="getCurrentLanguage()!=lang.key"><a ng-click="changeLanguage(lang.key)"><span class="icon icon-{{lang.key}}-24"></span>{{lang.label}}</a></li></ul></li>')}]);
//# sourceMappingURL=../oasp/oasp.min.js.map